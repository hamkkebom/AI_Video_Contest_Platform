<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="doc-version" content="v0.2-mockup">
  <meta name="doc-status" content="ê¸°ì—… ë¶„ë¦¬ ë°˜ì˜">
  <meta name="last-modified" content="2026-02-23">
  <meta name="project" content="í•¨ê»˜ë´„ AI ì˜ìƒ ê³µëª¨ì „ í”Œë«í¼">
  <title>DB ì„¤ê³„ì„œ (ERD + í…Œì´ë¸” ì •ì˜) - í•¨ê»˜ë´„ AI ì˜ìƒ ê³µëª¨ì „ í”Œë«í¼</title>
  <link rel="stylesheet" href="../assets/style.css">
  <link rel="stylesheet" href="../assets/print.css">
</head>
<body>
  <main>
    <h1>ğŸ—„ï¸ DB ì„¤ê³„ì„œ (ERD + í…Œì´ë¸” ì •ì˜)</h1>
    <p><code>lib/types/index.ts</code> ê¸°ì¤€ ì¸í„°í˜ì´ìŠ¤ë¥¼ ê´€ê³„í˜• í…Œì´ë¸”ë¡œ ë§¤í•‘í•œ ëª©ì—…ìš© DB ì„¤ê³„ ë¬¸ì„œë‹¤.</p>
    <button id="pdf-button" class="pdf-button" type="button">ğŸ“„ PDF ë‹¤ìš´ë¡œë“œ</button>
    <div class="doc-meta">
      <strong>ë¬¸ì„œ ì •ë³´:</strong> v0.2-mockup | ìµœì¢… ìˆ˜ì •: 2026-02-23 | ìƒíƒœ: ê¸°ì—… ë¶„ë¦¬ ë°˜ì˜
    </div>

    <h2>1. ì¸í„°í˜ì´ìŠ¤-í…Œì´ë¸” ë§¤í•‘</h2>
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>í…Œì´ë¸”ëª…</th>
          <th>ì›ë³¸ íƒ€ì…</th>
          <th>ë„ë©”ì¸</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>TBL-001</td><td>users</td><td>User</td><td>ì‚¬ìš©ì</td></tr>
        <tr><td>TBL-002</td><td>demo_roles</td><td>DemoRoles</td><td>ì‚¬ìš©ì</td></tr>
        <tr><td>TBL-003</td><td>devices</td><td>Device</td><td>ì‚¬ìš©ì</td></tr>
        <tr><td>TBL-004</td><td>contests</td><td>Contest</td><td>ê³µëª¨ì „</td></tr>
        <tr><td>TBL-005</td><td>submissions</td><td>Submission</td><td>ê³µëª¨ì „</td></tr>
        <tr><td>TBL-006</td><td>likes</td><td>Like</td><td>ì½˜í…ì¸ </td></tr>
        <tr><td>TBL-007</td><td>judges</td><td>Judge</td><td>ì‹¬ì‚¬</td></tr>
        <tr><td>TBL-008</td><td>judging_templates</td><td>JudgingTemplate</td><td>ì‹¬ì‚¬</td></tr>
        <tr><td>TBL-009</td><td>judging_criteria</td><td>JudgingCriterion</td><td>ì‹¬ì‚¬</td></tr>
        <tr><td>TBL-010</td><td>scores</td><td>Score</td><td>ì‹¬ì‚¬</td></tr>
        <tr><td>TBL-011</td><td>score_criteria_scores</td><td>Score.criteriaScores[]</td><td>ì‹¬ì‚¬</td></tr>
        <tr><td>TBL-012</td><td>contest_results</td><td>ContestResult</td><td>ì‹¬ì‚¬</td></tr>
        <tr><td>TBL-013</td><td>articles</td><td>Article</td><td>ì½˜í…ì¸ </td></tr>
        <tr><td>TBL-014</td><td>faqs</td><td>FAQ</td><td>ì½˜í…ì¸ </td></tr>
        <tr><td>TBL-015</td><td>inquiries</td><td>Inquiry</td><td>ì½˜í…ì¸ </td></tr>
        <tr><td>TBL-016</td><td>agency_requests</td><td>AgencyRequest</td><td>ì½˜í…ì¸ </td></tr>
        <tr><td>TBL-017</td><td>activity_logs</td><td>ActivityLog</td><td>ë¶„ì„</td></tr>
        <tr><td>TBL-018</td><td>ip_logs</td><td>IpLog</td><td>ë¶„ì„</td></tr>
        <tr><td>TBL-019</td><td>utm_templates</td><td>UTMTemplate</td><td>ë¶„ì„</td></tr>
        <tr><td>TBL-020</td><td>pricing_plans</td><td>PricingPlan</td><td>ì‚¬ìš©ì</td></tr>
        <tr><td>TBL-021</td><td>plan_feature_access</td><td>PlanFeatureAccess, FeatureAccessByRole</td><td>ì‚¬ìš©ì</td></tr>
        <tr><td>TBL-022</td><td>regional_metrics</td><td>RegionalMetric</td><td>ë¶„ì„</td></tr>
        <tr><td>TBL-023</td><td>companies</td><td>Company</td><td>ê¸°ì—…</td></tr>
        <tr><td>TBL-024</td><td>company_members</td><td>CompanyMember</td><td>ê¸°ì—…</td></tr>
      </tbody>
    </table>
    <p><strong>ë¹„í…Œì´ë¸” íƒ€ì…:</strong> <code>ContestFilters</code>, <code>SubmissionFilters</code>, <code>SearchFilters</code>, <code>SearchResult</code>ëŠ” ì¡°íšŒ DTO/ì‘ë‹µ ì¡°í•©ìœ¼ë¡œ ë¬¼ë¦¬ í…Œì´ë¸”ì—ì„œ ì œì™¸í•œë‹¤.</p>

    <h2>2. ì „ì²´ ERD</h2>
    <div class="mermaid">
erDiagram
  USERS ||--o{ DEVICES : owns
  USERS ||--o{ COMPANY_MEMBERS : belongs_to
  COMPANIES ||--o{ COMPANY_MEMBERS : has
  COMPANIES ||--o{ CONTESTS : hosts
  USERS ||--o{ CONTESTS : manages
  USERS ||--o{ SUBMISSIONS : creates
  USERS ||--o{ ARTICLES : writes
  USERS ||--o{ INQUIRIES : submits
  USERS ||--o{ ACTIVITY_LOGS : generates
  USERS ||--o{ IP_LOGS : has
  USERS ||--o{ LIKES : gives
  USERS ||--o{ DEMO_ROLES : has
  CONTESTS ||--o{ SUBMISSIONS : receives
  CONTESTS ||--o{ JUDGES : assigns
  CONTESTS ||--o{ CONTEST_RESULTS : publishes
  JUDGING_TEMPLATES ||--o{ JUDGING_CRITERIA : contains
  JUDGING_TEMPLATES ||--o{ SCORES : used_by
  SUBMISSIONS ||--o{ SCORES : evaluated
  JUDGES ||--o{ SCORES : gives
  SCORES ||--o{ SCORE_CRITERIA_SCORES : details
  SUBMISSIONS ||--o{ LIKES : liked
    </div>

    <h2>3. ë„ë©”ì¸ë³„ ë¶„í•  ERD (5ê°œ ë„ë©”ì¸)</h2>
    <h3>3.1 ê¸°ì—…/ì‚¬ìš©ì/ê³µëª¨ì „/ì‹¬ì‚¬</h3>
    <div class="mermaid">
erDiagram
  COMPANIES ||--o{ COMPANY_MEMBERS : has
  USERS ||--o{ COMPANY_MEMBERS : belongs_to
  COMPANIES ||--o{ CONTESTS : hosts
  USERS ||--o{ CONTESTS : manages
  USERS ||--o{ SUBMISSIONS : creates
  CONTESTS ||--o{ SUBMISSIONS : receives
  CONTESTS ||--o{ JUDGES : has
  JUDGES ||--o{ SCORES : writes
  SUBMISSIONS ||--o{ SCORES : receives
  JUDGING_TEMPLATES ||--o{ JUDGING_CRITERIA : has
  JUDGING_TEMPLATES ||--o{ SCORES : referenced
  CONTESTS ||--o{ CONTEST_RESULTS : finalizes
    </div>

    <h3>3.2 ì½˜í…ì¸ /ë¶„ì„</h3>
    <div class="mermaid">
erDiagram
  USERS ||--o{ ARTICLES : authors
  USERS ||--o{ INQUIRIES : asks
  USERS ||--o{ LIKES : clicks
  SUBMISSIONS ||--o{ LIKES : target
  USERS ||--o{ ACTIVITY_LOGS : logs
  USERS ||--o{ IP_LOGS : logs
  UTM_TEMPLATES ||--o{ ACTIVITY_LOGS : campaign_hint
  REGIONAL_METRICS ||--o{ CONTESTS : aggregates
    </div>

    <h2>4. í…Œì´ë¸” ì •ì˜ì„œ</h2>
    <table>
      <thead>
        <tr>
          <th>í…Œì´ë¸”</th>
          <th>ì»¬ëŸ¼</th>
          <th>íƒ€ì…</th>
          <th>ì œì•½ì¡°ê±´</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>TBL-001 users</td><td>id, email, name, nickname, role, region, created_at, status, avatar_url</td><td>uuid/text/enum/timestamptz</td><td>PK(id), UQ(email), NN(email,name,role,region,created_at,status)</td></tr>
        <tr><td>TBL-002 demo_roles</td><td>user_id, is_guest, is_participant, is_host, is_judge, is_admin</td><td>uuid/boolean</td><td>PK(user_id), FK(user_idâ†’users.id), NN(all flags)</td></tr>
        <tr><td>TBL-003 devices</td><td>id, user_id, name, platform, browser, ip_address, last_active_at, created_at, is_trusted</td><td>uuid/text/enum/timestamptz/boolean</td><td>PK(id), FK(user_id), NN(user_id,name,platform,browser,ip_address,last_active_at,created_at,is_trusted)</td></tr>
        <tr><td>TBL-004 contests</td><td>id, title, slug, host_company_id, host_user_id, description, region, tags, status, submission_start_at, submission_end_at, judging_start_at, judging_end_at, result_announced_at, judging_type, review_policy, max_submissions_per_user, allowed_video_extensions</td><td>uuid/text/text[]/enum/timestamptz/int</td><td>PK(id), UQ(slug), FK(host_company_idâ†’companies.id, host_user_idâ†’users.id), NN(í•µì‹¬ ì»¬ëŸ¼ ì „ë¶€)</td></tr>
        <tr><td>TBL-005 submissions</td><td>id, contest_id, user_id, title, description, video_url, thumbnail_url, status, submitted_at, views, like_count, tags, auto_rejected_reason</td><td>uuid/text/enum/timestamptz/int/text[]</td><td>PK(id), FK(contest_idâ†’contests.id,user_idâ†’users.id), NN(í•„ìˆ˜ ì»¬ëŸ¼), CK(views&gt;=0, like_count&gt;=0)</td></tr>
        <tr><td>TBL-006 likes</td><td>id, user_id, submission_id, created_at</td><td>uuid/timestamptz</td><td>PK(id), FK(user_idâ†’users.id,submission_idâ†’submissions.id), UQ(user_id,submission_id), NN(all)</td></tr>
        <tr><td>TBL-007 judges</td><td>id, user_id, contest_id, is_external, email, invited_at, accepted_at</td><td>uuid/boolean/text/timestamptz</td><td>PK(id), FK(user_idâ†’users.id,contest_idâ†’contests.id), UQ(user_id,contest_id), NN(user_id,contest_id,is_external,invited_at)</td></tr>
        <tr><td>TBL-008 judging_templates</td><td>id, name, description, created_at</td><td>uuid/text/timestamptz</td><td>PK(id), NN(name,description,created_at)</td></tr>
        <tr><td>TBL-009 judging_criteria</td><td>id, template_id, label, max_score, description</td><td>uuid/text/int</td><td>PK(id), FK(template_idâ†’judging_templates.id), NN(template_id,label,max_score,description), CK(max_score&gt;0)</td></tr>
        <tr><td>TBL-010 scores</td><td>id, submission_id, judge_id, template_id, total, comment, created_at</td><td>uuid/int/text/timestamptz</td><td>PK(id), FK(submission_idâ†’submissions.id,judge_idâ†’judges.id,template_idâ†’judging_templates.id), UQ(submission_id,judge_id), NN(submission_id,judge_id,template_id,total,created_at)</td></tr>
        <tr><td>TBL-011 score_criteria_scores</td><td>id, score_id, criterion_id, score</td><td>uuid/int</td><td>PK(id), FK(score_idâ†’scores.id,criterion_idâ†’judging_criteria.id), NN(score_id,criterion_id,score)</td></tr>
        <tr><td>TBL-012 contest_results</td><td>contest_id, submission_id, rank, prize_label, awarded_at</td><td>uuid/int/text/timestamptz</td><td>PK(contest_id,submission_id), FK(contest_idâ†’contests.id,submission_idâ†’submissions.id), NN(all)</td></tr>
        <tr><td>TBL-013 articles</td><td>id, type, title, slug, excerpt, content, author_id, tags, published_at, is_published, thumbnail_url</td><td>uuid/enum/text/text[]/timestamptz/boolean</td><td>PK(id), UQ(slug), FK(author_idâ†’users.id), NN(type,title,slug,excerpt,content,author_id,published_at,is_published)</td></tr>
        <tr><td>TBL-014 faqs</td><td>id, category, question, answer, is_pinned, updated_at</td><td>uuid/enum/text/boolean/timestamptz</td><td>PK(id), NN(category,question,answer,is_pinned,updated_at)</td></tr>
        <tr><td>TBL-015 inquiries</td><td>id, user_id, type, title, content, status, created_at, updated_at</td><td>uuid/enum/text/timestamptz</td><td>PK(id), FK(user_idâ†’users.id), NN(user_id,type,title,content,status,created_at,updated_at)</td></tr>
        <tr><td>TBL-016 agency_requests</td><td>id, company_name, contact_name, contact_email, phone_number, budget_range, message, status, created_at</td><td>uuid/text/enum/timestamptz</td><td>PK(id), NN(company_name,contact_name,contact_email,message,status,created_at)</td></tr>
        <tr><td>TBL-017 activity_logs</td><td>id, user_id, action, target_type, target_id, created_at, metadata</td><td>uuid/text/timestamptz/jsonb</td><td>PK(id), FK(user_idâ†’users.id), NN(user_id,action,target_type,target_id,created_at)</td></tr>
        <tr><td>TBL-018 ip_logs</td><td>id, user_id, ip_address, country, region, risk_level, created_at</td><td>uuid/text/enum/timestamptz</td><td>PK(id), FK(user_idâ†’users.id), NN(user_id,ip_address,country,region,risk_level,created_at)</td></tr>
        <tr><td>TBL-019 utm_templates</td><td>id, name, source, medium, campaign, term, content, created_at</td><td>uuid/text/timestamptz</td><td>PK(id), NN(name,source,medium,campaign,created_at)</td></tr>
        <tr><td>TBL-020 pricing_plans</td><td>id, role, name, monthly_price, yearly_price, active, feature_keys</td><td>uuid/enum/text/numeric/boolean/text[]</td><td>PK(id), NN(role,name,monthly_price,yearly_price,active)</td></tr>
        <tr><td>TBL-021 plan_feature_access</td><td>id, role, feature_key, free, label</td><td>uuid/enum/text/boolean</td><td>PK(id), UQ(role,feature_key), NN(role,feature_key,free,label)</td></tr>
        <tr><td>TBL-022 regional_metrics</td><td>region, user_count, contest_count, submission_count</td><td>text/int</td><td>PK(region), NN(all), ì§‘ê³„ ë·° ë˜ëŠ” ë¨¸í„°ë¦¬ì–¼ë¼ì´ì¦ˆë“œ ë·° ê¶Œì¥</td></tr>
        <tr><td>TBL-023 companies</td><td>id, name, business_number, representative_name, address, phone, logo_url, website, description, created_at, updated_at</td><td>uuid/text/timestamptz</td><td>PK(id), UQ(business_number), NN(name,business_number,representative_name,created_at,updated_at)</td></tr>
        <tr><td>TBL-024 company_members</td><td>id, company_id, user_id, role, joined_at</td><td>uuid/enum/timestamptz</td><td>PK(id), FK(company_idâ†’companies.id, user_idâ†’users.id), UQ(company_id,user_id), NN(company_id,user_id,role,joined_at)</td></tr>
      </tbody>
    </table>

    <h2>5. ê´€ê³„ ì •ì˜ (í•µì‹¬ FK)</h2>
    <table>
      <thead>
        <tr>
          <th>ê´€ê³„</th>
          <th>ì„¤ëª…</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>company_members.company_id â†’ companies.id</td><td>ê¸°ì—… ì†Œì† ë§¤í•‘</td></tr>
        <tr><td>company_members.user_id â†’ users.id</td><td>ê¸°ì—… ë©¤ë²„ ì‚¬ìš©ì ì°¸ì¡°</td></tr>
        <tr><td>contests.host_company_id â†’ companies.id</td><td>ê³µëª¨ì „ ì£¼ìµœ ê¸°ì—… ì°¸ì¡°</td></tr>
        <tr><td>contests.host_user_id â†’ users.id</td><td>ê³µëª¨ì „ ì£¼ìµœ ë‹´ë‹¹ì ì°¸ì¡°</td></tr>
        <tr><td>submissions.contest_id â†’ contests.id</td><td>ì¶œí’ˆì‘ì˜ ì†Œì† ê³µëª¨ì „</td></tr>
        <tr><td>submissions.user_id â†’ users.id</td><td>ì¶œí’ˆì ì°¸ì¡°</td></tr>
        <tr><td>judges.user_id â†’ users.id, judges.contest_id â†’ contests.id</td><td>ì‹¬ì‚¬ìœ„ì› ë°°ì •</td></tr>
        <tr><td>scores.submission_id â†’ submissions.id</td><td>ì‘í’ˆ ì±„ì </td></tr>
        <tr><td>scores.judge_id â†’ judges.id</td><td>ì±„ì  ì£¼ì²´</td></tr>
        <tr><td>likes.user_id â†’ users.id, likes.submission_id â†’ submissions.id</td><td>ì¢‹ì•„ìš” ì´ë ¥</td></tr>
      </tbody>
    </table>

    <h2>6. ì¸ë±ìŠ¤ ì „ëµ</h2>
    <table>
      <thead>
        <tr>
          <th>í…Œì´ë¸”</th>
          <th>ì¸ë±ìŠ¤</th>
          <th>ê·¼ê±°</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>companies</td><td>UQ(business_number), BTREE(name)</td><td>ì‚¬ì—…ìë²ˆí˜¸ ì¤‘ë³µ ë°©ì§€, ê¸°ì—…ëª… ê²€ìƒ‰</td></tr>
        <tr><td>company_members</td><td>UQ(company_id, user_id), (user_id)</td><td>ì¤‘ë³µ ì†Œì† ë°©ì§€, ì‚¬ìš©ìë³„ ì†Œì† ì¡°íšŒ</td></tr>
        <tr><td>contests</td><td>(status, region), GIN(tags), BTREE(slug), (host_company_id)</td><td>ëª©ë¡ í•„í„°/ê²€ìƒ‰/ìƒì„¸ ì¡°íšŒ/ê¸°ì—…ë³„ ê³µëª¨ì „ ì¡°íšŒ ìµœì í™”</td></tr>
        <tr><td>submissions</td><td>(contest_id, status), (user_id, submitted_at desc), GIN(tags)</td><td>ì ‘ìˆ˜í•¨/ë‚´ ì œì¶œë¬¼/ìƒíƒœ íƒ­</td></tr>
        <tr><td>likes</td><td>UNIQUE(user_id, submission_id), (submission_id)</td><td>í† ê¸€ ì¤‘ë³µ ë°©ì§€, ì´ ì¢‹ì•„ìš” ì§‘ê³„</td></tr>
        <tr><td>scores</td><td>UNIQUE(submission_id, judge_id), (template_id)</td><td>ì¤‘ë³µ ì±„ì  ë°©ì§€, í…œí”Œë¦¿ë³„ í†µê³„</td></tr>
        <tr><td>inquiries</td><td>(status, created_at desc), (user_id)</td><td>ìƒë‹´ ëŒ€ê¸°ì—´/ì‚¬ìš©ì íˆìŠ¤í† ë¦¬</td></tr>
        <tr><td>activity_logs</td><td>(user_id, created_at desc), (target_type, target_id)</td><td>ê°ì‚¬ ì¶”ì  ë° ì—”í„°í‹° ë‹¨ìœ„ ì¡°íšŒ</td></tr>
        <tr><td>ip_logs</td><td>(user_id, created_at desc), (risk_level)</td><td>ë³´ì•ˆ ëª¨ë‹ˆí„°ë§</td></tr>
      </tbody>
    </table>

    <h2>7. í™•ì¥ ë²”ìœ„ ë©”ëª¨</h2>
    <ul>
      <li>Phase 2/3 í…Œì´ë¸”ì€ ë³¸ ERDì— í¬í•¨í•˜ì§€ ì•Šê³ , ë³„ë„ ë¬¸ì„œì—ì„œ ì¦ë¶„ ê´€ë¦¬í•œë‹¤.</li>
      <li>ë¶„ì„ ìŠ¤í‚¤ë§ˆì˜ visitors/sessions/campaigns/events/identity_linksëŠ” ì•„í‚¤í…ì²˜ ë¬¸ì„œ ê¸°ì¤€ìœ¼ë¡œë§Œ ì°¸ì¡°í•œë‹¤.</li>
      <li>v0.2 ë³€ê²½ì‚¬í•­: usersì—ì„œ company_name ì‚­ì œ, companies/company_members í…Œì´ë¸” ì‹ ì„¤, contestsì—ì„œ host_id â†’ host_company_id + host_user_id ë¶„ë¦¬.</li>
    </ul>
  </main>
  <script src="../assets/docs.js" defer></script>
</body>
</html>
